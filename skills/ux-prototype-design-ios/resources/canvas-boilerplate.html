<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UX Prototype Canvas</title>
    <link rel="stylesheet" href="ios-base.css">
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #f0f0f0;
            font-family: -apple-system, sans-serif;
        }

        #canvas-container {
            width: 100%;
            height: 100%;
            cursor: grab;
            position: relative;
            overflow: hidden;
            background-size: 20px 20px;
            background-image:
                linear-gradient(to right, #e0e0e0 1px, transparent 1px),
                linear-gradient(to bottom, #e0e0e0 1px, transparent 1px);
        }

        #canvas-container:active {
            cursor: grabbing;
        }

        #canvas-content {
            transform-origin: 0 0;
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Controls are now in ios-base.css */
    </style>
</head>

<body>

    <div id="canvas-container">
        <div id="canvas-content">
            <!-- PROTOTYPE CONTENT GOES HERE -->
        </div>
    </div>

    <div id="controls">
        <button onclick="resetView()">Reset View</button>
        <div class="control-hint">Pan: Drag | Zoom: Scroll</div>
    </div>

    <script>
        const container = document.getElementById('canvas-container');
        const content = document.getElementById('canvas-content');

        let state = {
            scale: 1,
            panning: false,
            pointX: 0,
            pointY: 0,
            startX: 0,
            startY: 0
        };

        const setTransform = () => {
            content.style.transform = `translate(${state.pointX}px, ${state.pointY}px) scale(${state.scale})`;
        }

        container.onmousedown = function (e) {
            if (e.target.closest('#controls')) return;
            e.preventDefault();
            state.startX = e.clientX - state.pointX;
            state.startY = e.clientY - state.pointY;
            state.panning = true;
        }

        container.onmouseup = function (e) {
            state.panning = false;
        }

        container.onmousemove = function (e) {
            if (!state.panning) return;
            e.preventDefault();
            state.pointX = (e.clientX - state.startX);
            state.pointY = (e.clientY - state.startY);
            setTransform();
        }

        container.onwheel = function (e) {
            e.preventDefault();
            const xs = (e.clientX - state.pointX) / state.scale;
            const ys = (e.clientY - state.pointY) / state.scale;
            const delta = -e.deltaY;

            (delta > 0) ? (state.scale *= 1.1) : (state.scale /= 1.1);
            state.scale = Math.min(Math.max(0.05, state.scale), 10);

            state.pointX = e.clientX - xs * state.scale;
            state.pointY = e.clientY - ys * state.scale;

            setTransform();
        }

        function drawBezierFlow(svg, startX, startY, endX, endY) {
            const cp1x = startX + (endX - startX) * 0.5;
            const cp2x = endX - (endX - startX) * 0.5;

            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            const d = `M ${startX} ${startY} C ${cp1x} ${startY}, ${cp2x} ${endY}, ${endX} ${endY}`;
            path.setAttribute("d", d);
            path.setAttribute("stroke", "#007AFF");
            path.setAttribute("stroke-width", "3");
            path.setAttribute("stroke-dasharray", "8,8");
            path.setAttribute("fill", "none");
            path.setAttribute("marker-end", "url(#arrowhead)");
            svg.appendChild(path);
        }

        function resetView() {
            state.scale = 0.5;
            state.pointX = 100;
            state.pointY = 200;
            setTransform();
        }

        // UI Helpers to reduce HTML size
        function injectCommonUI() {
            document.querySelectorAll('.screen').forEach(screen => {
                if (!screen.querySelector('.status-bar')) {
                    const sb = document.createElement('div');
                    sb.className = 'status-bar';
                    sb.innerHTML = '<span>9:41</span><span>ï£¿</span>';
                    screen.prepend(sb);
                }
                if (!screen.querySelector('.home-indicator')) {
                    const hi = document.createElement('div');
                    hi.className = 'home-indicator';
                    screen.append(hi);
                }
            });
        }

        resetView();
        injectCommonUI();
    </script>
</body>

</html>